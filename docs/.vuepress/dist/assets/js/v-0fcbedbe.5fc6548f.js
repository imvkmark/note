"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8463],{1937:(n,e,s)=>{s.r(e),s.d(e,{data:()=>r});const r={key:"v-0fcbedbe",path:"/nginx/example/https.html",title:"配置 HTTPS",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"配置后的访问规则",slug:"配置后的访问规则",children:[]},{level:2,title:"强烈推荐",slug:"强烈推荐",children:[]},{level:2,title:"参考链接",slug:"参考链接",children:[]}],filePathRelative:"nginx/example/https.md",git:{updatedTime:1629648513e3,contributors:[{name:"duoli",email:"zhaody901@126.com",commits:1}]}}},5731:(n,e,s)=>{s.r(e),s.d(e,{default:()=>L});var r=s(6252);const a=(0,r._)("h1",{id:"配置-https",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#配置-https","aria-hidden":"true"},"#"),(0,r.Uk)(" 配置 HTTPS")],-1),t=(0,r.Uk)("首先配置支持 HTTPS 必须让 Nginx 开启 "),l=(0,r._)("code",null,"http_ssl_module",-1),o=(0,r.Uk)(" 模块，"),i=(0,r.Uk)("点击查看nginx编译安装参数"),p=(0,r.Uk)(" ，可以使用"),c=(0,r._)("code",null,"nginx -V",-1),b=(0,r.Uk)("查看是否开启"),u=(0,r._)("code",null,"TLS SNI support enabled",-1),d=(0,r.Uk)("。"),m=(0,r.Uk)("购买/生成 SSL 证书，可以使用免费的证书，比如："),h={href:"https://imququ.com/post/letsencrypt-certificate.html",target:"_blank",rel:"noopener noreferrer"},x=(0,r.Uk)("Let's Encrypt，免费好用的 HTTPS 证书"),w=(0,r.Uk)(" 。"),f=(0,r.uE)('<div class="language-conf ext-conf line-numbers-mode"><pre class="language-conf"><code># 配置 HTTPS\n\n# 配置个http的站点，用来做重定向，当然如果你不需要把 HTTP-&gt;HTTPS 可以把这个配置删了\nserver {\n    listen       80;\n\n    # 配置域名\n    server_name foo.com;\n\n    # 添加 STS, 并让所有子域支持, 开启需慎重\n    add_header strict-transport-security &#39;max-age=31536000; includeSubDomains; preload&#39;;\n\n    # 配置让这些 HTTP 的访问全部 301 重定向到 HTTPS 的\n    return 301 https://foo.com$request_uri;\n}\n\n# 配置 HTTPS\nserver {\n    # 配置域名\n    server_name www.xxoo.com xxoo.com;\n\n    # https默认端口\n    listen 443 ssl;\n\n    # 添加STS, 并让所有子域支持, 开启需慎重\n    add_header strict-transport-security &#39;max-age=31536000; includeSubDomains; preload&#39;;\n\n    # https配置\n    ssl on;\n    ssl_certificate /xxoo/www.xxoo.com.crt;\n    ssl_certificate_key /xxoo/www.xxoo.com.key;\n\n    # 其他按正常配置处理即可...\n}\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><blockquote><p>注意，这里证书的格式是 <code>.crt</code> 的。</p></blockquote><h2 id="配置后的访问规则" tabindex="-1"><a class="header-anchor" href="#配置后的访问规则" aria-hidden="true">#</a> 配置后的访问规则</h2><table><thead><tr><th>输入链接</th><th>最终访问链接</th></tr></thead><tbody><tr><td>http://www.xxoo.com</td><td>https://www.xxoo.com</td></tr><tr><td>http://www.xxoo.com/404/500</td><td>https://www.xxoo.com/404/500</td></tr><tr><td>http://xxoo.com</td><td>https://www.xxoo.com</td></tr><tr><td>https://www.xxoo.com</td><td>-（原链接不变）</td></tr><tr><td>https://xxoo.com/500</td><td>https://www.xxoo.com/500</td></tr></tbody></table><h2 id="强烈推荐" tabindex="-1"><a class="header-anchor" href="#强烈推荐" aria-hidden="true">#</a> 强烈推荐</h2>',5),k=(0,r.Uk)("使用 "),g={href:"https://github.com/Neilpang/acme.sh",target:"_blank",rel:"noopener noreferrer"},_=(0,r.Uk)("https://github.com/Neilpang/acme.sh"),T=(0,r.Uk)(" 支持泛域名证书申请了，好赞。 详细的使用文档参考 "),S={href:"https://github.com/acmesh-official/acme.sh/wiki/%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"},U=(0,r.Uk)("acme.sh/wiki/说明"),v=(0,r._)("h2",{id:"参考链接",tabindex:"-1"},[(0,r._)("a",{class:"header-anchor",href:"#参考链接","aria-hidden":"true"},"#"),(0,r.Uk)(" 参考链接")],-1),H={href:"https://serversforhackers.com/c/redirect-http-to-https-nginx",target:"_blank",rel:"noopener noreferrer"},P=(0,r.Uk)("Redirect HTTP to HTTPS in Nginx"),y={href:"https://serverfault.com/questions/250476/how-to-force-or-redirect-to-ssl-in-nginx",target:"_blank",rel:"noopener noreferrer"},q=(0,r.Uk)("How to force or redirect to SSL in nginx?"),L={render:function(n,e){const s=(0,r.up)("RouterLink"),L=(0,r.up)("OutboundLink");return(0,r.wg)(),(0,r.iD)(r.HY,null,[a,(0,r._)("p",null,[t,l,o,(0,r.Wm)(s,{to:"/guide/nginx-configure-descriptions.html"},{default:(0,r.w5)((()=>[i])),_:1}),p,c,b,u,d]),(0,r._)("p",null,[m,(0,r._)("a",h,[x,(0,r.Wm)(L)]),w]),f,(0,r._)("p",null,[k,(0,r._)("a",g,[_,(0,r.Wm)(L)]),T,(0,r._)("a",S,[U,(0,r.Wm)(L)])]),v,(0,r._)("ul",null,[(0,r._)("li",null,[(0,r._)("a",H,[P,(0,r.Wm)(L)])]),(0,r._)("li",null,[(0,r._)("a",y,[q,(0,r.Wm)(L)])])])],64)}}}}]);