"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4853],{4560:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-0dbbc899",path:"/nginx/example/cors.html",title:"配置 CORS 跨域",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"设置允许所有的请求",slug:"设置允许所有的请求",children:[]},{level:2,title:"只允许GET请求",slug:"只允许get请求",children:[]},{level:2,title:"请求白名单",slug:"请求白名单",children:[]},{level:2,title:"iconfont 字体跨域配置",slug:"iconfont-字体跨域配置",children:[]}],filePathRelative:"nginx/example/cors.md",git:{updatedTime:1629648513e3,contributors:[{name:"duoli",email:"zhaody901@126.com",commits:1}]}}},1529:(n,s,a)=>{a.r(s),a.d(s,{default:()=>p});const e=(0,a(6252).uE)('<h1 id="配置-cors-跨域" tabindex="-1"><a class="header-anchor" href="#配置-cors-跨域" aria-hidden="true">#</a> 配置 CORS 跨域</h1><h2 id="设置允许所有的请求" tabindex="-1"><a class="header-anchor" href="#设置允许所有的请求" aria-hidden="true">#</a> 设置允许所有的请求</h2><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Origin&#39;</span> <span class="token string">&#39;*&#39;</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="只允许get请求" tabindex="-1"><a class="header-anchor" href="#只允许get请求" aria-hidden="true">#</a> 只允许GET请求</h2><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Origin&#39;</span> <span class="token string">&#39;*&#39;</span></span><span class="token punctuation">;</span>\n        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Request-Method&#39;</span> <span class="token string">&#39;GET&#39;</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="请求白名单" tabindex="-1"><a class="header-anchor" href="#请求白名单" aria-hidden="true">#</a> 请求白名单</h2><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>\n        <span class="token comment"># 白名单</span>\n        <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$http_origin</span> ~* (baidu\\.com|github.xuexb.com)$)</span> <span class="token punctuation">{</span>\n            <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Origin&#39;</span> <span class="token string">&#39;<span class="token variable">$http_origin</span>&#39;</span></span><span class="token punctuation">;</span>\n\n            <span class="token comment"># 允许cookie</span>\n            <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Credentials&#39;</span> true</span><span class="token punctuation">;</span>\n\n            <span class="token comment"># 只允许某些方法</span>\n            <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Request-Method&#39;</span> <span class="token string">&#39;GET, POST, OPTIONS&#39;</span></span><span class="token punctuation">;</span>\n\n            <span class="token comment"># 支持获取其她字段, 需要前端设置 `xhr.withCredentials = true`</span>\n            <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Headers&#39;</span> <span class="token string">&#39;User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&#39;</span></span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="iconfont-字体跨域配置" tabindex="-1"><a class="header-anchor" href="#iconfont-字体跨域配置" aria-hidden="true">#</a> iconfont 字体跨域配置</h2><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token directive"><span class="token keyword">root</span> xxx</span><span class="token punctuation">;</span>\n\n    <span class="token comment"># 使用location来匹配以字体文件</span>\n    <span class="token directive"><span class="token keyword">location</span> ~* \\.(eot|otf|ttf|woff|svg)$</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">add_header</span> Access-Control-Allow-Origin *</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>但如果你的 <code>location</code> 已经配置了, 可以使用 <code>if</code> 判断添加, 如:</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>\n        <span class="token comment"># 使用判断请求文件来添加</span>\n        <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$document_uri</span> ~ \\.(eot|otf|ttf|woff|svg)$)</span> <span class="token punctuation">{</span>\n            <span class="token directive"><span class="token keyword">add_header</span> Access-Control-Allow-Origin *</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>',11),p={render:function(n,s){return e}}}}]);