"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5405],{106:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-02aeefb2",path:"/nginx/example/error-page.html",title:"Nginx 状态码配置和错误文件",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:3,title:"error_page配置小提示",slug:"error-page配置小提示",children:[]}],filePathRelative:"nginx/example/error-page.md",git:{updatedTime:1629648513e3,contributors:[{name:"duoli",email:"zhaody901@126.com",commits:1}]}}},9735:(n,s,a)=>{a.r(s),a.d(s,{default:()=>p});const e=(0,a(6252).uE)('<h1 id="nginx-状态码配置和错误文件" tabindex="-1"><a class="header-anchor" href="#nginx-状态码配置和错误文件" aria-hidden="true">#</a> Nginx 状态码配置和错误文件</h1><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token comment"># 配置访问 /test.js 时报 403 错</span>\n    <span class="token directive"><span class="token keyword">location</span> /test.js</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">403</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 配置访问 /404 时报 404 错</span>\n    <span class="token directive"><span class="token keyword">location</span> /404</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">404</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 配置访问 /500 时报 500 错</span>\n    <span class="token directive"><span class="token keyword">location</span> /500</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">500</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 把指定状态码指向这个文件 uri</span>\n    <span class="token directive"><span class="token keyword">error_page</span> <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span> /status.html</span><span class="token punctuation">;</span>\n    <span class="token directive"><span class="token keyword">error_page</span> <span class="token number">404</span> /status.html</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>如:</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>\n    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>\n    <span class="token directive"><span class="token keyword">server_name</span> test.me</span><span class="token punctuation">;</span>\n\n    <span class="token directive"><span class="token keyword">root</span> /Users/xiaowu/work/test.me</span><span class="token punctuation">;</span>\n\n    <span class="token comment"># 用if匹配任何以 403 开头的，会匹配到 /4034444</span>\n    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_uri</span> ~* ^/403)</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">403</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 用location匹配 /500/ /500，但不匹配 /500/1</span>\n    <span class="token directive"><span class="token keyword">location</span> ~* <span class="token string">&quot;^/500/?$&quot;</span></span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">500</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 用if匹配以 /501/ 开头的，匹配 /501/1，/501/1/2 但不匹配 /501</span>\n    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_uri</span> ~* ^/501/)</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">501</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 用location匹配 /502/ /502 /502/1 /502/1/2</span>\n    <span class="token directive"><span class="token keyword">location</span> ~* <span class="token string">&quot;^/502(/.*)?$&quot;</span></span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">502</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment"># 用location只匹配 /503</span>\n    <span class="token directive"><span class="token keyword">location</span> = /503</span> <span class="token punctuation">{</span>\n        <span class="token directive"><span class="token keyword">return</span> <span class="token number">503</span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="error-page配置小提示" tabindex="-1"><a class="header-anchor" href="#error-page配置小提示" aria-hidden="true">#</a> error_page配置小提示</h3><p>注意 <code>error_page</code> 配置时加 <code>=</code> 和不加 <code>=</code> 的区别，加了 <code>=</code> 表示响应为指定的 <code>http status code</code> ，默认为 200，不加 <code>=</code> 为原错误的状态码~</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment"># 这样可以访问错误页面时 http status 为 404 ，并且页面内容是 404.html 的内容</span>\n<span class="token directive"><span class="token keyword">error_page</span> <span class="token number">404</span> /404.html\nerror_page <span class="token number">404</span> <span class="token number">500</span> /404.html</span><span class="token punctuation">;</span>\n\n<span class="token comment"># 这样配置访问错误页面时 http status 为 200 ，但页面内容是 404.html 的内容</span>\n<span class="token directive"><span class="token keyword">error_page</span> <span class="token number">404</span> <span class="token number">500</span> = /404.html</span><span class="token punctuation">;</span>\n\n<span class="token comment"># 这样配置访问错误页面时 http status 为 404 ，但页面内容是 404.html 的内容</span>\n<span class="token directive"><span class="token keyword">error_page</span> <span class="token number">404</span> <span class="token number">500</span> =404 /404.html</span><span class="token punctuation">;</span>\n\n<span class="token comment"># 也可以把404请求直接301到某个域上</span>\n<span class="token directive"><span class="token keyword">error_page</span> <span class="token number">404</span> =301 https://xuexb.com/404</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这样就可以根据自己需求配置错误页为指定的状态码，因为非 200 的状态码可能会被浏览器拦截。</p>',8),p={render:function(n,s){return e}}}}]);